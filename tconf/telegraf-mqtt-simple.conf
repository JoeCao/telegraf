[agent]
  interval = "30s"
  round_interval = true
  metric_batch_size = 1000
  metric_buffer_limit = 10000

# SNMP 数据采集
[[inputs.snmp]]
  agents = ["localhost:161"]
  version = 2
  community = "public"
  interval = "30s"
  timeout = "5s"
  retries = 3

  # 系统信息
  [[inputs.snmp.field]]
    name = "system_description"
    oid = "1.3.6.1.2.1.1.1.0"

  [[inputs.snmp.field]]
    name = "system_uptime"
    oid = "1.3.6.1.2.1.1.3.0"

  [[inputs.snmp.field]]
    name = "system_name"
    oid = "1.3.6.1.2.1.1.5.0"

  [[inputs.snmp.field]]
    name = "interface_count"
    oid = "1.3.6.1.2.1.2.1.0"

  # 接口统计表
  [[inputs.snmp.table]]
    name = "interface"
    oid = "1.3.6.1.2.1.2.2"

    [[inputs.snmp.table.field]]
      name = "ifDescr"
      oid = "1.3.6.1.2.1.2.2.1.2"
      is_tag = true

    [[inputs.snmp.table.field]]
      name = "ifOperStatus"
      oid = "1.3.6.1.2.1.2.2.1.8"

    [[inputs.snmp.table.field]]
      name = "ifInOctets"
      oid = "1.3.6.1.2.1.2.2.1.10"

    [[inputs.snmp.table.field]]
      name = "ifOutOctets"
      oid = "1.3.6.1.2.1.2.2.1.16"

    [[inputs.snmp.table.field]]
      name = "ifSpeed"
      oid = "1.3.6.1.2.1.2.2.1.5"

# MQTT 输出 - 使用标准 JSON 格式
[[outputs.mqtt]]
  servers = ["tcp://your-mqtt-broker:1883"]
  # username = "your_username"  # 如需认证
  # password = "your_password"  # 如需认证
  client_id = "telegraf-snmp"
  topic = "network/{{ .Name }}/data"

  # 使用 JSON 格式 - 这是最通用的格式
  data_format = "json"

  # 或者使用 InfluxDB 行协议（更紧凑）
  # data_format = "influx"

  keep_alive = 60
  timeout = "5s"
  qos = 1

# 调试输出
[[outputs.file]]
  files = ["stdout"]
  data_format = "json"