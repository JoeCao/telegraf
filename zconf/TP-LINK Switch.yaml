zabbix_export:
  version: '6.0'
  date: '2023-06-14T03:45:24Z'
  groups:
    -
      uuid: 4acea20ba1254054930e725442fccd0f
      name: Templates
  templates:
    -
      uuid: 08d946497cc24c32af54cbf7a9d4b996
      template: 'TP-LINK Switch'
      name: 'TP-LINK Switch'
      groups:
        -
          name: Templates
      items:
        -
          uuid: b69f3d9d77684d609380fce397e89226
          name: 'ICMP Ping'
          type: SIMPLE
          key: icmpping
          history: 7d
          valuemap:
            name: state
          tags:
            -
              tag: component
              value: health
            -
              tag: component
              value: network
          triggers:
            -
              uuid: 07244d7ebc894e5dae0b54c9fecd989b
              expression: 'max(/TP-LINK Switch/icmpping,#3)=0'
              name: 'ICMP Ping 不通'
              priority: DISASTER
              description: 'Last three attempts returned timeout.  Please check device connectivity.'
              tags:
                -
                  tag: scope
                  value: availability
        -
          uuid: 0a9772d4dbde4d7ea324160a6e48c844
          name: 'ICMP Ping 丢包率'
          type: SIMPLE
          key: icmppingloss
          history: 7d
          value_type: FLOAT
          units: '%'
          tags:
            -
              tag: component
              value: health
            -
              tag: component
              value: network
          triggers:
            -
              uuid: 5fe9dbe446a540ad8973d01c23fb9911
              expression: 'min(/TP-LINK Switch/icmppingloss,5m)>{$ICMP.LOSS.WARN} and min(/TP-LINK Switch/icmppingloss,5m)<100'
              name: 'ICMP Ping 丢包率持续 5 分钟大于 {$ICMP.LOSS.WARN}%'
              priority: AVERAGE
              dependencies:
                -
                  name: 'ICMP Ping 不通'
                  expression: 'max(/TP-LINK Switch/icmpping,#3)=0'
              tags:
                -
                  tag: scope
                  value: availability
                -
                  tag: scope
                  value: performance
        -
          uuid: 3407298d7a0445429f3a98d525161c78
          name: 'ICMP Ping 延迟'
          type: SIMPLE
          key: icmppingsec
          history: 7d
          value_type: FLOAT
          units: s
          tags:
            -
              tag: component
              value: health
            -
              tag: component
              value: network
          triggers:
            -
              uuid: 638167471b9c4aa389d67117a17a52d7
              expression: 'avg(/TP-LINK Switch/icmppingsec,5m)>{$ICMP.RESPONSE_TIME.WARN}'
              name: 'ICMP Ping 5 分钟平均延迟大于 {$ICMP.RESPONSE_TIME.WARN} 秒'
              priority: AVERAGE
              dependencies:
                -
                  name: 'ICMP Ping 不通'
                  expression: 'max(/TP-LINK Switch/icmpping,#3)=0'
                -
                  name: 'ICMP Ping 丢包率持续 5 分钟大于 {$ICMP.LOSS.WARN}%'
                  expression: 'min(/TP-LINK Switch/icmppingloss,5m)>{$ICMP.LOSS.WARN} and min(/TP-LINK Switch/icmppingloss,5m)<100'
              tags:
                -
                  tag: scope
                  value: availability
                -
                  tag: scope
                  value: performance
        -
          uuid: fb798385d5d740a5989c4d7d95bb6995
          name: 系统联系人
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.4.0
          key: system.contact
          history: 7d
          trends: '0'
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            The textual identification of the contact person for this managed node, together with information on how to contact this person.  If no contact information is known, the value is the zero-length string.
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            -
              tag: component
              value: system
        -
          uuid: 7ae6ae329f004fbb95289cbb08f27a4f
          name: 'CPU 使用率'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#CPU.UTIL},1.3.6.1.4.1.11863.6.4.1.1.1.1.3]'
          key: system.cpu.util
          history: 7d
          units: '%'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$..[''{#CPU.UTIL}''].avg()'
          tags:
            -
              tag: component
              value: cpu
          triggers:
            -
              uuid: f570b1a375b04490ab866125d7095cbb
              expression: 'min(/TP-LINK Switch/system.cpu.util,5m)>{$CPU.UTIL.CRIT}'
              name: 'CPU 使用率持续 5 分钟大于 {$CPU.UTIL.CRIT}%'
              priority: AVERAGE
              description: 'CPU 使用率过高, 设备存在性能问题'
              tags:
                -
                  tag: scope
                  value: performance
        -
          uuid: 9e6458834b7e48a98becec457cc0bde0
          name: 系统描述
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.1.0
          key: system.descr
          history: 7d
          trends: '0'
          value_type: TEXT
          description: |
            MIB: SNMPv2-MIB
            A textual description of the entity. This value should
            include the full name and version identification of the system's hardware type, software operating-system, and
            networking software.
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            -
              tag: component
              value: system
        -
          uuid: a673c66bf41b428c96353e958c8018c0
          name: 固件版本
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.11863.6.1.1.6.0
          key: system.hw.firmware
          history: 7d
          trends: '0'
          value_type: CHAR
          description: |
            MIB: TPLINK-SYSINFO-MIB
            The software version of the product.
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            -
              tag: component
              value: system
        -
          uuid: 21a40749b5c04be1baed0e1e6b3b4d12
          name: 硬件型号名称
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.11863.6.1.1.5.0
          key: system.hw.model
          history: 7d
          trends: '0'
          value_type: CHAR
          description: |
            MIB: TPLINK-SYSINFO-MIB
            The hardware version of the product.
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            -
              tag: component
              value: system
        -
          uuid: 500e145d37bd4055833ed323bd739927
          name: 硬件版本
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.11863.6.1.1.5.0
          key: system.hw.version
          history: 7d
          trends: '0'
          value_type: CHAR
          description: |
            MIB: TPLINK-SYSINFO-MIB
            The hardware version of the product.
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            -
              tag: component
              value: system
        -
          uuid: 6d4837a8cf9249378192802de36784e4
          name: 系统位置
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.6.0
          key: system.location
          history: 7d
          trends: '0'
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            The physical location of this node (e.g., `telephone closet, 3rd floor').  If the location is unknown, the value is the zero-length string.
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            -
              tag: component
              value: system
        -
          uuid: d303fb2071084f449aaf238852847544
          name: 系统名称
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.5.0
          key: system.name
          history: 7d
          trends: '0'
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            An administratively-assigned name for this managed node.By convention, this is the node's fully-qualified domain name.  If the name is unknown, the value is the zero-length string.
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            -
              tag: component
              value: system
          triggers:
            -
              uuid: 8a5a260027d04ffbac0933a2d5ea9998
              expression: 'last(/TP-LINK Switch/system.name,#1)<>last(/TP-LINK Switch/system.name,#2) and length(last(/TP-LINK Switch/system.name))>0'
              name: 系统名称发生变更
              priority: INFO
              tags:
                -
                  tag: scope
                  value: notice
                -
                  tag: scope
                  value: security
        -
          uuid: 5b4f2687f8da4d22aee66190189b762e
          name: '系统 ObjectID'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.2.0
          key: system.objectid
          history: 7d
          trends: '0'
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            The vendor's authoritative identification of the network management subsystem contained in the entity.  This value is allocated within the SMI enterprises subtree (1.3.6.1.4.1) and provides an easy and unambiguous means for determining`what kind of box' is being managed.  For example, if vendor`Flintstones, Inc.' was assigned the subtree1.3.6.1.4.1.4242, it could assign the identifier 1.3.6.1.4.1.4242.1.1 to its `Fred Router'.
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            -
              tag: component
              value: system
        -
          uuid: 160d09480e98472aab2f21a7737b52cd
          name: 系统状态
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.1588.2.1.1.1.1.7.0
          key: system.status
          history: 7d
          description: |
            MIB: SW-MIB
            The current operational status of the switch.The states are as follow:
            online(1) means the switch is accessible by an external  Fibre Channel port
            offline(2) means the switch is not accessible
            testing(3) means the switch is in a built-in test mode and is not accessible by an external Fibre Channel port
            faulty(4) means the switch is not operational.
          tags:
            -
              tag: component
              value: status
          triggers:
            -
              uuid: 2de14f4067c84ec5a22ee36e303838d0
              expression: 'last(/TP-LINK Switch/system.status)={$HEALTH_CRIT_STATUS}'
              name: 系统处于异常状态
              priority: AVERAGE
              description: |
                Last value: {ITEM.LASTVALUE1}.
                Please check the device for errors
            -
              uuid: 08385734b67b43b8954f7f4f178e94cf
              expression: 'last(/TP-LINK Switch/system.status)={$HEALTH_WARN_STATUS:"offline"} or last(/TP-LINK Switch/system.status)={$HEALTH_WARN_STATUS:"testing"}'
              name: 系统处于警告状态
              priority: WARNING
              description: |
                Last value: {ITEM.LASTVALUE1}.
                Please check the device for warnings
              dependencies:
                -
                  name: 系统处于异常状态
                  expression: 'last(/TP-LINK Switch/system.status)={$HEALTH_CRIT_STATUS}'
        -
          uuid: d0b123f9a42e4e4c9f6a225c43accdb5
          name: 运行时长
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.3.0
          key: system.uptime
          history: 7d
          trends: '0'
          units: uptime
          description: |
            MIB: SNMPv2-MIB
            The time (in hundredths of a second) since the network management portion of the system was last re-initialized.
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            -
              tag: component
              value: system
          triggers:
            -
              uuid: 2d41cf490b764ed7bff8c85de4665c0c
              expression: 'last(/TP-LINK Switch/system.uptime)<10m'
              name: 软件层面发生重启
              priority: WARNING
              description: 'Uptime is less than 10 minutes.'
              dependencies:
                -
                  name: 'SNMP 不可用'
                  expression: 'max(/TP-LINK Switch/zabbix[host,snmp,available],5m)=0'
              tags:
                -
                  tag: scope
                  value: notice
        -
          uuid: 8ee723b4529e4b7b892e245686c820cf
          name: 内存使用率
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#MEM.UTIL},1.3.6.1.4.1.11863.6.4.1.2.1.1.2]'
          key: vm.memory.util
          history: 7d
          units: '%'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$..[''{#MEM.UTIL}''].avg()'
          tags:
            -
              tag: component
              value: memory
          triggers:
            -
              uuid: b92be5c9e354437b8bfbfdf7f52a88d1
              expression: 'min(/TP-LINK Switch/vm.memory.util,5m)>{$MEMORY.UTIL.CRIT}'
              name: '内存使用率持续 5 分钟大于 {$MEMORY.UTIL.CRIT}%'
              priority: AVERAGE
              description: 'Memory utilization is too high. The system might be slow to respond.'
              tags:
                -
                  tag: scope
                  value: performance
        -
          uuid: e1ea64bd90ca499f8ed109b72e5355e7
          name: 'SNMP 可用性'
          type: INTERNAL
          key: 'zabbix[host,snmp,available]'
          history: 7d
          description: |
            Availability of SNMP checks on the host. The value of this item corresponds to availability icons in the host list.
            Possible value:
            0 - not available
            1 - available
            2 - unknown
          valuemap:
            name: available
          tags:
            -
              tag: component
              value: health
            -
              tag: component
              value: network
          triggers:
            -
              uuid: 3b34bbc5a74b4de1ae4befcb0eca82e9
              expression: 'max(/TP-LINK Switch/zabbix[host,snmp,available],5m)=0'
              name: 'SNMP 不可用'
              priority: HIGH
              description: 'SNMP 协议端口不可达，请检查设备的网络连接和设备上的 SNMP 设置'
              dependencies:
                -
                  name: 'ICMP Ping 不通'
                  expression: 'max(/TP-LINK Switch/icmpping,#3)=0'
              tags:
                -
                  tag: scope
                  value: availability
      discovery_rules:
        -
          uuid: a185cf78e63e443c957ca038c9bacc81
          name: 'CPU 自动发现'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},1.3.6.1.4.1.11863.6.4.1.1.1.1.1]'
          key: cpu.discovery
          delay: 5m
          lifetime: 3h
          description: 'Discovering TPLINK-SYSMONITOR-MIB::tpSysMonitorCpuTable, displays the CPU utilization of all UNITs.'
          item_prototypes:
            -
              uuid: 8b7ad540d52948228f57d09190722f53
              name: 'CPU {#SNMPINDEX}: 使用率'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.11863.6.4.1.1.1.1.3.{#SNMPINDEX}'
              key: 'system.cpu.util[{#SNMPINDEX}]'
              history: 7d
              value_type: FLOAT
              units: '%'
              description: |
                MIB: TPLINK-SYSMONITOR-MIB
                Displays the CPU utilization in 1 minute.
                Reference: http://www.tp-link.com/faq-1330.html
              tags:
                -
                  tag: component
                  value: cpu
              trigger_prototypes:
                -
                  uuid: ecf8c4c78c9e41438de527021c1f6541
                  expression: 'min(/TP-LINK Switch/system.cpu.util[{#SNMPINDEX}],5m)>{$CPU.UTIL.CRIT}'
                  name: 'CPU {#SNMPINDEX}: 使用率持续 5 分钟大于 {$CPU.UTIL.CRIT}%'
                  priority: AVERAGE
                  description: 'CPU utilization is too high. The system might be slow to respond.'
                  tags:
                    -
                      tag: scope
                      value: performance
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        -
          uuid: 51cc939f381742b3a30fb6acefb6f78d
          name: 内存自动发现
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},1.3.6.1.4.1.11863.6.4.1.2.1.1.1]'
          key: memory.discovery
          delay: 5m
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#MEMTYPE}'
                value: '{$MEMORY.TYPE.MATCHES}'
                formulaid: C
              -
                macro: '{#MEMTYPE}'
                value: '{$MEMORY.TYPE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: D
              -
                macro: '{#MEMNAME}'
                value: '{$MEMORY.NAME.MATCHES}'
                formulaid: A
              -
                macro: '{#MEMNAME}'
                value: '{$MEMORY.NAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          lifetime: 3h
          description: 'Discovering TPLINK-SYSMONITOR-MIB::tpSysMonitorMemoryTable, displays the memory utilization of all UNITs.'
          item_prototypes:
            -
              uuid: 33a4008c14d34ebda74ca6a11edcb295
              name: '内存 {#SNMPINDEX}: 使用率'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.11863.6.4.1.2.1.1.2.{#SNMPINDEX}'
              key: 'vm.memory.util[tpSysMonitorMemoryUtilization.{#SNMPINDEX}]'
              history: 7d
              value_type: FLOAT
              units: '%'
              description: |
                MIB: TPLINK-SYSMONITOR-MIB
                Displays the memory utilization.
                Reference: http://www.tp-link.com/faq-1330.html
              tags:
                -
                  tag: component
                  value: memory
              trigger_prototypes:
                -
                  uuid: f17896b5f0634adb9676997c7de79e38
                  expression: 'min(/TP-LINK Switch/vm.memory.util[tpSysMonitorMemoryUtilization.{#SNMPINDEX}],5m)>{$MEMORY.UTIL.CRIT}'
                  name: '内存 {#SNMPINDEX}: 使用率持续 5 分钟大于 {$MEMORY.UTIL.CRIT}%'
                  priority: AVERAGE
                  description: 'The system is running out of free memory.'
                  tags:
                    -
                      tag: scope
                      value: capacity
                    -
                      tag: scope
                      value: performance
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        -
          uuid: 749b9a398ca84f9d89267825ae0b2961
          name: 网口自动发现
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7,{#IFNAME},1.3.6.1.2.1.2.2.1.2,{#IFDESCR},1.3.6.1.2.1.2.2.1.2,{#IFTYPE},1.3.6.1.2.1.2.2.1.3]'
          key: net.if.discovery
          delay: 5m
          lifetime: 3h
          description: 'Discovering interfaces from IF-MIB.'
          item_prototypes:
            -
              uuid: 00d22eac27924a2fb99c11dcefcede21
              name: '网口 {#IFNAME}: 入流量'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.10.{#SNMPINDEX}'
              key: 'net.if.in[ifHCInOctets.{#SNMPINDEX}]'
              history: 7d
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets received on the interface,including framing characters. Discontinuities in the value of this counter can occur at re-initialization of the management system, and atother times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                -
                  tag: component
                  value: network
                -
                  tag: interface
                  value: '{#IFNAME}'
            -
              uuid: 45d0deab79054d4dbec98bd65955c87d
              name: '网口 {#IFNAME}: 出流量'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.16.{#SNMPINDEX}'
              key: 'net.if.out[ifHCOutOctets.{#SNMPINDEX}]'
              history: 7d
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets transmitted out of the interface, including framing characters. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                -
                  tag: component
                  value: network
                -
                  tag: interface
                  value: '{#IFNAME}'
            -
              uuid: 2730a3be39a14976bbbf5f8daf06e208
              name: '网口 {#IFNAME}: 速率'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.5.{#SNMPINDEX}'
              key: 'net.if.speed[ifHighSpeed.{#SNMPINDEX}]'
              history: 7d
              trends: '0'
              units: bps
              description: |
                MIB: IF-MIB
                An estimate of the interface's current bandwidth in bits per second.
                For interfaces which do not vary in bandwidth or for those where no accurate estimation can be made,
                this object should contain the nominal bandwidth.
                If the bandwidth of the interface is greater than the maximum value reportable by this object then
                this object should report its maximum value (4,294,967,295) and ifHighSpeed must be used to report the interface's speed.
                For a sub-layer which has no concept of bandwidth, this object should be zero.
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              tags:
                -
                  tag: component
                  value: network
                -
                  tag: interface
                  value: '{#IFNAME}'
            -
              uuid: 8539a1264d9343d29bf5df1ec3481d51
              name: '网口 {#IFNAME}: 状态'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}'
              key: 'net.if.status[ifOperStatus.{#SNMPINDEX}]'
              history: 7d
              trends: '0'
              description: |
                MIB: IF-MIB
                The current operational state of the interface.
                - The testing(3) state indicates that no operational packet scan be passed
                - If ifAdminStatus is down(2) then ifOperStatus should be down(2)
                - If ifAdminStatus is changed to up(1) then ifOperStatus should change to up(1) if the interface is ready to transmit and receive network traffic
                - It should change todormant(5) if the interface is waiting for external actions (such as a serial line waiting for an incoming connection)
                - It should remain in the down(2) state if and only if there is a fault that prevents it from going to the up(1) state
                - It should remain in the notPresent(6) state if the interface has missing(typically, hardware) components.
              valuemap:
                name: ifOperStatus
              tags:
                -
                  tag: component
                  value: network
                -
                  tag: interface
                  value: '{#IFNAME}'
              trigger_prototypes:
                -
                  uuid: 425899fc4f40494fa20e66072b020d4a
                  expression: '{$NET.IFCONTROL:"{#IFNAME}"}=1 and last(/TP-LINK Switch/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/TP-LINK Switch/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/TP-LINK Switch/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/TP-LINK Switch/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$NET.IFCONTROL:"{#IFNAME}"}=0'
                  name: '网口 {#IFNAME}: 状态异常'
                  priority: HIGH
                  description: |
                    This trigger expression works as follows:
                    1. Can be triggered if operations status is down.
                    2. {$NET.IFCONTROL:"{#IFNAME}"}=1 - user can redefine Context macro to value - 0. That marks this interface as not important. No new trigger will be fired if this interface is down.
                    3. {TEMPLATE_NAME:METRIC.diff()}=1) - trigger fires only if operational status was up(1) sometime before. (So, do not fire 'ethernal off' interfaces.)
                    
                    WARNING: if closed manually - won't fire again on next poll, because of .diff.
                  tags:
                    -
                      tag: scope
                      value: availability
            -
              uuid: a8eb23832eeb408a971bc90e04c2ede3
              name: '网口 {#IFNAME}: 类型'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.3.{#SNMPINDEX}'
              key: 'net.if.type[ifType.{#SNMPINDEX}]'
              history: 7d
              trends: '0'
              description: |
                MIB: IF-MIB
                The type of interface.
                Additional values for ifType are assigned by the Internet Assigned Numbers Authority (IANA),
                through updating the syntax of the IANAifType textual convention.
              valuemap:
                name: ifType
              preprocessing:
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                -
                  tag: component
                  value: network
                -
                  tag: interface
                  value: '{#IFNAME}'
          trigger_prototypes:
            -
              uuid: 44dae814685a424898df0b89cc9f928d
              expression: |
                (avg(/TP-LINK Switch/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)>({$NET.IF.UTIL.CRIT:"{#IFNAME}"}/100)*last(/TP-LINK Switch/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) or
                avg(/TP-LINK Switch/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)>({$NET.IF.UTIL.CRIT:"{#IFNAME}"}/100)*last(/TP-LINK Switch/net.if.speed[ifHighSpeed.{#SNMPINDEX}])) and
                last(/TP-LINK Switch/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                avg(/TP-LINK Switch/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)<(({$NET.IF.UTIL.CRIT:"{#IFNAME}"}-3)/100)*last(/TP-LINK Switch/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) and
                avg(/TP-LINK Switch/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)<(({$NET.IF.UTIL.CRIT:"{#IFNAME}"}-3)/100)*last(/TP-LINK Switch/net.if.speed[ifHighSpeed.{#SNMPINDEX}])
              name: '网口 {#IFNAME}: 带宽使用率持续 15 分钟大于 {$NET.IF.UTIL.CRIT:"{#IFNAME}"}%'
              priority: HIGH
              description: 'The network interface utilization is close to its estimated maximum bandwidth.'
              dependencies:
                -
                  name: '网口 {#IFNAME}: 状态异常'
                  expression: '{$NET.IFCONTROL:"{#IFNAME}"}=1 and last(/TP-LINK Switch/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/TP-LINK Switch/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/TP-LINK Switch/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_expression: 'last(/TP-LINK Switch/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$NET.IFCONTROL:"{#IFNAME}"}=0'
              tags:
                -
                  tag: scope
                  value: performance
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        -
          uuid: a0167004b74f4edab86f1078117d3052
          name: 双工网口自动发现
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},1.3.6.1.2.1.10.7.2.1.19,{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1,{#IFDESCR},1.3.6.1.2.1.2.2.1.2]'
          key: net.if.duplex.discovery
          delay: 5m
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#IFOPERSTATUS}'
                value: '1'
                formulaid: A
              -
                macro: '{#SNMPVALUE}'
                value: (2|3)
                formulaid: B
          lifetime: 3h
          item_prototypes:
            -
              uuid: 065ce321011f4047889fec772595e22b
              name: '网口 {#IFNAME}: 双工状态'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.10.7.2.1.19.{#SNMPINDEX}'
              key: 'net.if.duplex[dot3StatsDuplexStatus.{#SNMPINDEX}]'
              history: 7d
              valuemap:
                name: dot3StatsDuplexStatus
              tags:
                -
                  tag: component
                  value: network
                -
                  tag: interface
                  value: '{#IFNAME}'
              trigger_prototypes:
                -
                  uuid: 3bb7a82bdd4a47bc9e4501cc0e02d016
                  expression: 'last(/TP-LINK Switch/net.if.duplex[dot3StatsDuplexStatus.{#SNMPINDEX}])=2'
                  name: '网口 {#IFNAME}: 处于半双工状态'
                  priority: AVERAGE
                  tags:
                    -
                      tag: scope
                      value: performance
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  try {
                      var data = JSON.parse(value);
                  }
                  catch (error) {
                      throw 'Failed to parse JSON of EtherLike-MIB discovery.';
                  }
                  var fields = ['{#SNMPVALUE}','{#IFOPERSTATUS}','{#IFNAME}','{#IFDESCR}'];
                  data.forEach(function (element) {
                      fields.forEach(function (field) {
                          element[field] = element[field] || '';
                      });
                  });
                  return JSON.stringify(data);
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
      tags:
        -
          tag: class
          value: network
        -
          tag: type
          value: switch
        -
          tag: vendor
          value: tp_link
      valuemaps:
        -
          uuid: adb4d0a28cec4d1184a0dde6ec315f42
          name: dot3StatsDuplexStatus
          mappings:
            -
              value: '1'
              newvalue: unknown
            -
              value: '2'
              newvalue: halfDuplex
            -
              value: '3'
              newvalue: fullDuplex
        -
          uuid: 29997132d5304c628735c743b2324954
          name: ifOperStatus
          mappings:
            -
              value: '1'
              newvalue: up
            -
              value: '2'
              newvalue: down
            -
              value: '4'
              newvalue: unknown
            -
              value: '5'
              newvalue: dormant
            -
              value: '6'
              newvalue: notPresent
            -
              value: '7'
              newvalue: lowerLayerDown
        -
          uuid: d1a5f9eae8474d278d35d03f24142039
          name: ifType
          mappings:
            -
              value: '1'
              newvalue: other
            -
              value: '2'
              newvalue: regular1822
            -
              value: '3'
              newvalue: hdh1822
            -
              value: '4'
              newvalue: ddnX25
            -
              value: '5'
              newvalue: rfc877x25
            -
              value: '6'
              newvalue: ethernetCsmacd
            -
              value: '7'
              newvalue: iso88023Csmacd
            -
              value: '8'
              newvalue: iso88024TokenBus
            -
              value: '9'
              newvalue: iso88025TokenRing
            -
              value: '10'
              newvalue: iso88026Man
            -
              value: '11'
              newvalue: starLan
            -
              value: '12'
              newvalue: proteon10Mbit
            -
              value: '13'
              newvalue: proteon80Mbit
            -
              value: '14'
              newvalue: hyperchannel
            -
              value: '15'
              newvalue: fddi
            -
              value: '16'
              newvalue: lapb
            -
              value: '17'
              newvalue: sdlc
            -
              value: '18'
              newvalue: ds1
            -
              value: '19'
              newvalue: e1
            -
              value: '20'
              newvalue: basicISDN
            -
              value: '21'
              newvalue: primaryISDN
            -
              value: '22'
              newvalue: propPointToPointSerial
            -
              value: '23'
              newvalue: ppp
            -
              value: '24'
              newvalue: softwareLoopback
            -
              value: '25'
              newvalue: eon
            -
              value: '26'
              newvalue: ethernet3Mbit
            -
              value: '27'
              newvalue: nsip
            -
              value: '28'
              newvalue: slip
            -
              value: '29'
              newvalue: ultra
            -
              value: '30'
              newvalue: ds3
            -
              value: '31'
              newvalue: sip
            -
              value: '32'
              newvalue: frameRelay
            -
              value: '33'
              newvalue: rs232
            -
              value: '34'
              newvalue: para
            -
              value: '35'
              newvalue: arcnet
            -
              value: '36'
              newvalue: arcnetPlus
            -
              value: '37'
              newvalue: atm
            -
              value: '38'
              newvalue: miox25
            -
              value: '39'
              newvalue: sonet
            -
              value: '40'
              newvalue: x25ple
            -
              value: '41'
              newvalue: iso88022llc
            -
              value: '42'
              newvalue: localTalk
            -
              value: '43'
              newvalue: smdsDxi
            -
              value: '44'
              newvalue: frameRelayService
            -
              value: '45'
              newvalue: v35
            -
              value: '46'
              newvalue: hssi
            -
              value: '47'
              newvalue: hippi
            -
              value: '48'
              newvalue: modem
            -
              value: '49'
              newvalue: aal5
            -
              value: '50'
              newvalue: sonetPath
            -
              value: '51'
              newvalue: sonetVT
            -
              value: '52'
              newvalue: smdsIcip
            -
              value: '53'
              newvalue: propVirtual
            -
              value: '54'
              newvalue: propMultiplexor
            -
              value: '55'
              newvalue: ieee80212
            -
              value: '56'
              newvalue: fibreChannel
            -
              value: '57'
              newvalue: hippiInterface
            -
              value: '58'
              newvalue: frameRelayInterconnect
            -
              value: '59'
              newvalue: aflane8023
            -
              value: '60'
              newvalue: aflane8025
            -
              value: '61'
              newvalue: cctEmul
            -
              value: '62'
              newvalue: fastEther
            -
              value: '63'
              newvalue: isdn
            -
              value: '64'
              newvalue: v11
            -
              value: '65'
              newvalue: v36
            -
              value: '66'
              newvalue: g703at64k
            -
              value: '67'
              newvalue: g703at2mb
            -
              value: '68'
              newvalue: qllc
            -
              value: '69'
              newvalue: fastEtherFX
            -
              value: '70'
              newvalue: channel
            -
              value: '71'
              newvalue: ieee80211
            -
              value: '72'
              newvalue: ibm370parChan
            -
              value: '73'
              newvalue: escon
            -
              value: '74'
              newvalue: dlsw
            -
              value: '75'
              newvalue: isdns
            -
              value: '76'
              newvalue: isdnu
            -
              value: '77'
              newvalue: lapd
            -
              value: '78'
              newvalue: ipSwitch
            -
              value: '79'
              newvalue: rsrb
            -
              value: '80'
              newvalue: atmLogical
            -
              value: '81'
              newvalue: ds0
            -
              value: '82'
              newvalue: ds0Bundle
            -
              value: '83'
              newvalue: bsc
            -
              value: '84'
              newvalue: async
            -
              value: '85'
              newvalue: cnr
            -
              value: '86'
              newvalue: iso88025Dtr
            -
              value: '87'
              newvalue: eplrs
            -
              value: '88'
              newvalue: arap
            -
              value: '89'
              newvalue: propCnls
            -
              value: '90'
              newvalue: hostPad
            -
              value: '91'
              newvalue: termPad
            -
              value: '92'
              newvalue: frameRelayMPI
            -
              value: '93'
              newvalue: x213
            -
              value: '94'
              newvalue: adsl
            -
              value: '95'
              newvalue: radsl
            -
              value: '96'
              newvalue: sdsl
            -
              value: '97'
              newvalue: vdsl
            -
              value: '98'
              newvalue: iso88025CRFPInt
            -
              value: '99'
              newvalue: myrinet
            -
              value: '100'
              newvalue: voiceEM
            -
              value: '101'
              newvalue: voiceFXO
            -
              value: '102'
              newvalue: voiceFXS
            -
              value: '103'
              newvalue: voiceEncap
            -
              value: '104'
              newvalue: voiceOverIp
            -
              value: '105'
              newvalue: atmDxi
            -
              value: '106'
              newvalue: atmFuni
            -
              value: '107'
              newvalue: atmIma
            -
              value: '108'
              newvalue: pppMultilinkBundle
            -
              value: '109'
              newvalue: ipOverCdlc
            -
              value: '110'
              newvalue: ipOverClaw
            -
              value: '111'
              newvalue: stackToStack
            -
              value: '112'
              newvalue: virtualIpAddress
            -
              value: '113'
              newvalue: mpc
            -
              value: '114'
              newvalue: ipOverAtm
            -
              value: '115'
              newvalue: iso88025Fiber
            -
              value: '116'
              newvalue: tdlc
            -
              value: '117'
              newvalue: gigabitEthernet
            -
              value: '118'
              newvalue: hdlc
            -
              value: '119'
              newvalue: lapf
            -
              value: '120'
              newvalue: v37
            -
              value: '121'
              newvalue: x25mlp
            -
              value: '122'
              newvalue: x25huntGroup
            -
              value: '123'
              newvalue: trasnpHdlc
            -
              value: '124'
              newvalue: interleave
            -
              value: '125'
              newvalue: fast
            -
              value: '126'
              newvalue: ip
            -
              value: '127'
              newvalue: docsCableMaclayer
            -
              value: '128'
              newvalue: docsCableDownstream
            -
              value: '129'
              newvalue: docsCableUpstream
            -
              value: '130'
              newvalue: a12MppSwitch
            -
              value: '131'
              newvalue: tunnel
            -
              value: '132'
              newvalue: coffee
            -
              value: '133'
              newvalue: ces
            -
              value: '134'
              newvalue: atmSubInterface
            -
              value: '135'
              newvalue: l2vlan
            -
              value: '136'
              newvalue: l3ipvlan
            -
              value: '137'
              newvalue: l3ipxvlan
            -
              value: '138'
              newvalue: digitalPowerline
            -
              value: '139'
              newvalue: mediaMailOverIp
            -
              value: '140'
              newvalue: dtm
            -
              value: '141'
              newvalue: dcn
            -
              value: '142'
              newvalue: ipForward
            -
              value: '143'
              newvalue: msdsl
            -
              value: '144'
              newvalue: ieee1394
            -
              value: '145'
              newvalue: if-gsn
            -
              value: '146'
              newvalue: dvbRccMacLayer
            -
              value: '147'
              newvalue: dvbRccDownstream
            -
              value: '148'
              newvalue: dvbRccUpstream
            -
              value: '149'
              newvalue: atmVirtual
            -
              value: '150'
              newvalue: mplsTunnel
            -
              value: '151'
              newvalue: srp
            -
              value: '152'
              newvalue: voiceOverAtm
            -
              value: '153'
              newvalue: voiceOverFrameRelay
            -
              value: '154'
              newvalue: idsl
            -
              value: '155'
              newvalue: compositeLink
            -
              value: '156'
              newvalue: ss7SigLink
            -
              value: '157'
              newvalue: propWirelessP2P
            -
              value: '158'
              newvalue: frForward
            -
              value: '159'
              newvalue: rfc1483
            -
              value: '160'
              newvalue: usb
            -
              value: '161'
              newvalue: ieee8023adLag
            -
              value: '162'
              newvalue: bgppolicyaccounting
            -
              value: '163'
              newvalue: frf16MfrBundle
            -
              value: '164'
              newvalue: h323Gatekeeper
            -
              value: '165'
              newvalue: h323Proxy
            -
              value: '166'
              newvalue: mpls
            -
              value: '167'
              newvalue: mfSigLink
            -
              value: '168'
              newvalue: hdsl2
            -
              value: '169'
              newvalue: shdsl
            -
              value: '170'
              newvalue: ds1FDL
            -
              value: '171'
              newvalue: pos
            -
              value: '172'
              newvalue: dvbAsiIn
            -
              value: '173'
              newvalue: dvbAsiOut
            -
              value: '174'
              newvalue: plc
            -
              value: '175'
              newvalue: nfas
            -
              value: '176'
              newvalue: tr008
            -
              value: '177'
              newvalue: gr303RDT
            -
              value: '178'
              newvalue: gr303IDT
            -
              value: '179'
              newvalue: isup
            -
              value: '180'
              newvalue: propDocsWirelessMaclayer
            -
              value: '181'
              newvalue: propDocsWirelessDownstream
            -
              value: '182'
              newvalue: propDocsWirelessUpstream
            -
              value: '183'
              newvalue: hiperlan2
            -
              value: '184'
              newvalue: propBWAp2Mp
            -
              value: '185'
              newvalue: sonetOverheadChannel
            -
              value: '186'
              newvalue: digitalWrapperOverheadChannel
            -
              value: '187'
              newvalue: aal2
            -
              value: '188'
              newvalue: radioMAC
            -
              value: '189'
              newvalue: atmRadio
            -
              value: '190'
              newvalue: imt
            -
              value: '191'
              newvalue: mvl
            -
              value: '192'
              newvalue: reachDSL
            -
              value: '193'
              newvalue: frDlciEndPt
            -
              value: '194'
              newvalue: atmVciEndPt
            -
              value: '195'
              newvalue: opticalChannel
            -
              value: '196'
              newvalue: opticalTransport
            -
              value: '197'
              newvalue: propAtm
            -
              value: '198'
              newvalue: voiceOverCable
            -
              value: '199'
              newvalue: infiniband
            -
              value: '200'
              newvalue: teLink
            -
              value: '201'
              newvalue: q2931
            -
              value: '202'
              newvalue: virtualTg
            -
              value: '203'
              newvalue: sipTg
            -
              value: '204'
              newvalue: sipSig
            -
              value: '205'
              newvalue: docsCableUpstreamChannel
            -
              value: '206'
              newvalue: econet
            -
              value: '207'
              newvalue: pon155
            -
              value: '208'
              newvalue: pon622
            -
              value: '209'
              newvalue: bridge
            -
              value: '210'
              newvalue: linegroup
            -
              value: '211'
              newvalue: voiceEMFGD
            -
              value: '212'
              newvalue: voiceFGDEANA
            -
              value: '213'
              newvalue: voiceDID
            -
              value: '214'
              newvalue: mpegTransport
            -
              value: '215'
              newvalue: sixToFour
            -
              value: '216'
              newvalue: gtp
            -
              value: '217'
              newvalue: pdnEtherLoop1
            -
              value: '218'
              newvalue: pdnEtherLoop2
            -
              value: '219'
              newvalue: opticalChannelGroup
            -
              value: '220'
              newvalue: homepna
            -
              value: '221'
              newvalue: gfp
            -
              value: '222'
              newvalue: ciscoISLvlan
            -
              value: '223'
              newvalue: actelisMetaLOOP
            -
              value: '224'
              newvalue: fcipLink
            -
              value: '225'
              newvalue: rpr
            -
              value: '226'
              newvalue: qam
            -
              value: '227'
              newvalue: lmp
            -
              value: '228'
              newvalue: cblVectaStar
            -
              value: '229'
              newvalue: docsCableMCmtsDownstream
            -
              value: '230'
              newvalue: adsl2
            -
              value: '231'
              newvalue: macSecControlledIF
            -
              value: '232'
              newvalue: macSecUncontrolledIF
            -
              value: '233'
              newvalue: aviciOpticalEther
            -
              value: '234'
              newvalue: atmbond
            -
              value: '235'
              newvalue: voiceFGDOS
            -
              value: '236'
              newvalue: mocaVersion1
            -
              value: '237'
              newvalue: ieee80216WMAN
            -
              value: '238'
              newvalue: adsl2plus
            -
              value: '239'
              newvalue: dvbRcsMacLayer
            -
              value: '240'
              newvalue: dvbTdm
            -
              value: '241'
              newvalue: dvbRcsTdma
            -
              value: '242'
              newvalue: x86Laps
            -
              value: '243'
              newvalue: wwanPP
            -
              value: '244'
              newvalue: wwanPP2
            -
              value: '245'
              newvalue: voiceEBS
            -
              value: '246'
              newvalue: ifPwType
            -
              value: '247'
              newvalue: ilan
            -
              value: '248'
              newvalue: pip
            -
              value: '249'
              newvalue: aluELP
            -
              value: '250'
              newvalue: gpon
            -
              value: '251'
              newvalue: vdsl2
            -
              value: '252'
              newvalue: capwapDot11Profile
            -
              value: '253'
              newvalue: capwapDot11Bss
            -
              value: '254'
              newvalue: capwapWtpVirtualRadio
            -
              value: '255'
              newvalue: bits
            -
              value: '256'
              newvalue: docsCableUpstreamRfPort
            -
              value: '257'
              newvalue: cableDownstreamRfPort
            -
              value: '258'
              newvalue: vmwareVirtualNic
            -
              value: '259'
              newvalue: ieee802154
            -
              value: '260'
              newvalue: otnOdu
            -
              value: '261'
              newvalue: otnOtu
            -
              value: '262'
              newvalue: ifVfiType
            -
              value: '263'
              newvalue: g9981
            -
              value: '264'
              newvalue: g9982
            -
              value: '265'
              newvalue: g9983
            -
              value: '266'
              newvalue: aluEpon
            -
              value: '267'
              newvalue: aluEponOnu
            -
              value: '268'
              newvalue: aluEponPhysicalUni
            -
              value: '269'
              newvalue: aluEponLogicalLink
            -
              value: '270'
              newvalue: aluGponOnu
            -
              value: '271'
              newvalue: aluGponPhysicalUni
            -
              value: '272'
              newvalue: vmwareNicTeam
            -
              value: '277'
              newvalue: docsOfdmDownstream
            -
              value: '278'
              newvalue: docsOfdmaUpstream
            -
              value: '279'
              newvalue: gfast
            -
              value: '280'
              newvalue: sdci
            -
              value: '281'
              newvalue: xboxWireless
            -
              value: '282'
              newvalue: fastdsl
            -
              value: '283'
              newvalue: docsCableScte55d1FwdOob
            -
              value: '284'
              newvalue: docsCableScte55d1RetOob
            -
              value: '285'
              newvalue: docsCableScte55d2DsOob
            -
              value: '286'
              newvalue: docsCableScte55d2UsOob
            -
              value: '287'
              newvalue: docsCableNdf
            -
              value: '288'
              newvalue: docsCableNdr
            -
              value: '289'
              newvalue: ptm
            -
              value: '290'
              newvalue: ghn
        -
          uuid: 50f124ce463e4f518284fb6bf16b4b44
          name: state
          mappings:
            -
              value: '0'
              newvalue: down
            -
              value: '1'
              newvalue: up
        -
          uuid: a1e2d3de6b3e46c5b47ff8473314733c
          name: available
          mappings:
            -
              value: '0'
              newvalue: 'not available'
            -
              value: '1'
              newvalue: available
            -
              value: '2'
              newvalue: unknown
